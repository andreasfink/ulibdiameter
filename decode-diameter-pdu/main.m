//
//  main.m
//  decode-diameter-pdu
//
//  Created by Andreas Fink on 15.05.19.
//  Copyright Â© 2019 Andreas Fink. All rights reserved.
//

#import <Foundation/Foundation.h>
#import <ulibpcap/ulibpcap.h>
#import <ulibdiameter/ulibdiameter.h>

int main(int argc, const char * argv[])
{
	/* Update Location Request */
	NSString *str = @"010001c4c000013c010000232345cf002345cf0000000107400000594d4d454330312e4d4d45474933323736382e4d4d452e4550432e4d4e433030332e4d43433233342e334750504e4554574f524b2e4f52473b333234363939363039373b323034383434323632343b6d6d65000000000001154000000c00000001000001084000003f4d4d454330312e4d4d45474933323736382e4d4d452e4550432e4d4e433030332e4d43433233342e334750504e4554574f524b2e4f524700000001284000002d4d4d452e4550432e4d4e433030332e4d43433233342e334750504e4554574f524b2e4f5247000000000001254000001b6472616e6c30312e636f6d666f6e652e636f6d000000011b400000296570632e6d6e633031352e6d63633233342e336770706e6574776f726b2e6f726700000000000001400000173233343135393530363132313432350000000579c0000038000028af0000057ac000001a000028af333533373938303837313830343700000000057bc000000e000028af333100000000057dc0000010000028af000000020000057fc000000f000028af32f4300000000408c0000010000028af000003ec0000064f80000010000028af00000000";
	NSData *pdu = [str unhexedData];

	UMDiameterPacket *pkt = [[UMDiameterPacket alloc]initWithData:pdu];
	fprintf(stdout,"%s",pkt.description.UTF8String);
	return 0;
}
